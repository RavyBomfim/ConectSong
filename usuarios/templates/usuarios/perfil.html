{% extends 'paginas/index.html' %}

{% load static %}

{% load crispy_forms_tags %}

{% block styles %}
    <link rel="stylesheet" href="{% static 'css/perfil.css' %}">
{% endblock %}

{% block main %}
    <div class="container" id="main-container">
        <div id="perfil-informs-box">
            <form action="" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div id="capa">
                    <!-- <img src="{% static 'img/capa-generica.jpg' %}" alt="" id="foto-capa"> -->
                    {% if perfil.foto_capa %}
                        <img src="/media/{{perfil.foto_perfil}}" alt="" class="foto-de-perfil">
                    {% endif %}
                    <label for="foto-capa-input" class="btn-default" id="foto-capa-editar"> 
                        <input type="file" id="foto-capa-input" class="inputs-file">
                        <i class="fa-solid fa-camera"></i> Editar Capa
                    </label>
                    <div id="foto-perfil-box">
                        {% if perfil.foto_perfil %}
                            <img src="/media/{{perfil.foto_perfil}}" alt="" class="foto-de-perfil">
                        {% else %}
                            <img src="{% static 'img/perfil-generico.png' %}" alt="" class="foto-de-perfil">
                        {% endif %}

                        <input type="file" id="foto-perfil-input" class="inputs-file">
                    </div>
                    <label for="foto-perfil-input" id="foto-perfil-icone">
                        <i class="fa-solid fa-camera"></i>
                    </label>
                </div>
            </form>
            <div id="perfil-informs">
                <div id="perfil-nome">
                    <h2>{{perfil}}</h2>
                </div>
                <a href="{% url 'editar-perfil' request.user.perfil.pk %}" class="btn btn-default" id="editar-perfil">
                    <i class="fa-solid fa-pencil"></i> Editar Perfil
                </a>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        $(document).ready(function() {
            
            $('#id_foto_perfil').on('change', function(e) {
                var input = e.target;
                if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function(e) {
                    // Define a imagem de pré-visualização
                    $('#imagem-perfil').attr('src', e.target.result);
                };

                // Carrega o arquivo de imagem
                reader.readAsDataURL(input.files[0]);
                }
            });

        });
    </script>
{%endblock %}